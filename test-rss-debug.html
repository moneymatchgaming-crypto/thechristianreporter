<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RSS Feed Debug Test</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test-section { margin: 20px 0; padding: 20px; border: 1px solid #ccc; border-radius: 5px; }
        .success { background-color: #d4edda; border-color: #c3e6cb; }
        .error { background-color: #f8d7da; border-color: #f5c6cb; }
        .loading { background-color: #d1ecf1; border-color: #bee5eb; }
        button { padding: 10px 20px; margin: 5px; cursor: pointer; }
        pre { background: #f8f9fa; padding: 10px; border-radius: 3px; overflow-x: auto; }
    </style>
</head>
<body>
    <h1>RSS Feed Debug Test</h1>
    
    <div class="test-section">
        <h2>Environment Check</h2>
        <p>API Key configured: <span id="api-key-status">Checking...</span></p>
        <p>API Key length: <span id="api-key-length">-</span></p>
        <button onclick="checkEnvironment()">Check Environment</button>
    </div>

    <div class="test-section">
        <h2>Test RSS2JSON API</h2>
        <button onclick="testRSS2JSON()">Test RSS2JSON API</button>
        <div id="rss2json-result"></div>
    </div>

    <div class="test-section">
        <h2>Test Individual RSS Feeds</h2>
        <button onclick="testIndividualFeeds()">Test Individual Feeds</button>
        <div id="individual-feeds-result"></div>
    </div>

    <div class="test-section">
        <h2>Console Log</h2>
        <button onclick="clearLog()">Clear Log</button>
        <pre id="console-log"></pre>
    </div>

    <script>
        // Mock environment variable for testing
        const mockEnv = {
            VITE_RSS2JSON_API_KEY: 'YOUR_API_KEY_HERE' // This should be your actual key
        };

        function log(message) {
            const logElement = document.getElementById('console-log');
            const timestamp = new Date().toLocaleTimeString();
            logElement.textContent += `[${timestamp}] ${message}\n`;
            console.log(message);
        }

        function clearLog() {
            document.getElementById('console-log').textContent = '';
        }

        function checkEnvironment() {
            const apiKey = mockEnv.VITE_RSS2JSON_API_KEY;
            const statusElement = document.getElementById('api-key-status');
            const lengthElement = document.getElementById('api-key-length');
            
            if (apiKey && apiKey !== 'YOUR_API_KEY_HERE') {
                statusElement.textContent = '‚úÖ CONFIGURED';
                statusElement.style.color = 'green';
                lengthElement.textContent = apiKey.length;
                log(`‚úÖ API Key is configured (length: ${apiKey.length})`);
            } else {
                statusElement.textContent = '‚ùå NOT CONFIGURED';
                statusElement.style.color = 'red';
                lengthElement.textContent = '0';
                log('‚ùå API Key is NOT configured');
            }
        }

        async function testRSS2JSON() {
            const resultElement = document.getElementById('rss2json-result');
            resultElement.innerHTML = '<div class="loading">Testing RSS2JSON API...</div>';
            
            try {
                const apiKey = mockEnv.VITE_RSS2JSON_API_KEY;
                if (apiKey === 'YOUR_API_KEY_HERE') {
                    throw new Error('API Key not configured');
                }

                // Test with a simple RSS feed
                const testFeed = 'https://www.christianitytoday.com/rss';
                log(`üì° Testing RSS2JSON with feed: ${testFeed}`);
                
                const response = await fetch(`https://api.rss2json.com/v1/api.json?rss_url=${encodeURIComponent(testFeed)}&api_key=${apiKey}&count=3`);
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const data = await response.json();
                log(`üì° RSS2JSON response: ${JSON.stringify(data, null, 2)}`);
                
                if (data.status === 'ok' && data.items) {
                    resultElement.innerHTML = `
                        <div class="success">
                            ‚úÖ RSS2JSON API working! Got ${data.items.length} articles
                            <pre>${JSON.stringify(data, null, 2)}</pre>
                        </div>
                    `;
                } else {
                    resultElement.innerHTML = `
                        <div class="error">
                            ‚ùå RSS2JSON API error: ${data.message || 'Unknown error'}
                            <pre>${JSON.stringify(data, null, 2)}</pre>
                        </div>
                    `;
                }
            } catch (error) {
                log(`‚ùå RSS2JSON test failed: ${error.message}`);
                resultElement.innerHTML = `
                    <div class="error">
                        ‚ùå RSS2JSON test failed: ${error.message}
                    </div>
                `;
            }
        }

        async function testIndividualFeeds() {
            const resultElement = document.getElementById('individual-feeds-result');
            resultElement.innerHTML = '<div class="loading">Testing individual RSS feeds...</div>';
            
            const testFeeds = [
                'https://www.christianitytoday.com/rss',
                'https://www.christianpost.com/rss',
                'https://www.worthynews.com/feed'
            ];
            
            let results = [];
            
            for (const feed of testFeeds) {
                try {
                    log(`üì° Testing direct RSS feed: ${feed}`);
                    const response = await fetch(`https://api.allorigins.win/raw?url=${encodeURIComponent(feed)}`);
                    
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                    
                    const xmlText = await response.text();
                    log(`üì° Feed ${feed}: Got ${xmlText.length} characters`);
                    
                    if (xmlText.includes('<rss') || xmlText.includes('<feed')) {
                        results.push(`‚úÖ ${feed}: Valid RSS/Atom feed (${xmlText.length} chars)`);
                    } else {
                        results.push(`‚ùå ${feed}: Not a valid RSS feed`);
                    }
                } catch (error) {
                    log(`‚ùå Feed ${feed} failed: ${error.message}`);
                    results.push(`‚ùå ${feed}: ${error.message}`);
                }
            }
            
            resultElement.innerHTML = `
                <div class="success">
                    <h3>Individual Feed Test Results:</h3>
                    <ul>
                        ${results.map(result => `<li>${result}</li>`).join('')}
                    </ul>
                </div>
            `;
        }

        // Auto-check environment on load
        window.onload = function() {
            checkEnvironment();
            log('üöÄ RSS Debug Test Page Loaded');
        };
    </script>
</body>
</html>



